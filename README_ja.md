# OpenAI Whisperモデルによる多言語対応音声テキスト化・字幕生成システム

（Windows GUI版）

## 目次

1. [プロジェクト概要](#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E6%A6%82%E8%A6%81)

2. [ファイル構成](#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E6%A7%8B%E6%88%90)

3. [動作環境](#%E5%8B%95%E4%BD%9C%E7%92%B0%E5%A2%83)

4. [クイックスタート](#%E3%82%AF%E3%82%A4%E3%83%83%E3%82%AF%E3%82%B9%E3%82%BF%E3%83%BC%E3%83%88)

5. [Whisperモデルの説明](#whisper%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E8%AA%AC%E6%98%8E)

6. [調整可能なパラメータ](#%E8%AA%BF%E6%95%B4%E5%8F%AF%E8%83%BD%E3%81%AA%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF)

7. [出力ファイル形式](#%E5%87%BA%E5%8A%9B%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E5%BD%A2%E5%BC%8F)

8. [よくある質問（FAQ）](#%E3%82%88%E3%81%8F%E3%81%82%E3%82%8B%E8%B3%AA%E5%95%8Ffaq)

---

## プロジェクト概要

本プロジェクトには、2つの独立したWindows用実行ファイルが含まれています。必要に応じて、右側の **Releases** セクションから完全な `.exe` ファイルをダウンロードしてください。

| プログラム                    | 機能                                     | 特徴                                                       |
| ------------------------ | -------------------------------------- | -------------------------------------------------------- |
| **PyTorch_Download.exe** | *PyTorch + Whisper* 依存ファイルの一括ダウンロード＆検証 | CPU / GPU (CUDA) 両対応  多言語GUI（日本語 / 中国語 / 英語 / 韓国語）       |
| **Transcription.exe**    | 音声テキスト化・字幕生成用GUIツール                    | 多言語インターフェース  Whisperモデル自動ダウンロード/ロード キーワード補助・パラメータ調整・進捗表示 |

---

## ファイル構成



├─PyTorch_Download.exe        # 依存関係ダウンローダー  

├─Transcription.exe           # 音声テキスト化用GUI  

├─pytorch_libs\               # ダウンロード後の依存関係（オフライン用）  └─Pycode\                     # ソースコードとビルドスクリ   

   ├─PyTorch_Downloader.py    # Downloaderのソースコード  

   ├─Transcription.py         # Transcriptionのソースコード   

   └─third_party_wheels\      # 任意のサードパーティ製wheel

> **補足**
> 
> - プログラムを自分で編集・再パッケージしたい場合のみ `Pycode\` フォルダをご利用ください。通常使用時は不要です。
> 
> - ダウンロードした依存ファイルは `pytorch_libs\` に展開され、オフライン環境でも使用可能です。

---

## 動作環境

| 項目        | 説明                                                              |
| --------- | --------------------------------------------------------------- |
| OS        | Windows 10 / 11（64bit）                                          |
| CPU / メモリ | 最新のx86-64 CPU / メモリ4GB以上                                        |
| GPU（任意）   | NVIDIA CUDA 11.8 / 12.x ＋ 対応ドライバ                                |
| その他       | GPUを使用する場合は **CUDA Toolkit** の事前インストールが必要です（インストール方法はWeb参照）     |
| ffmpeg    | オープンソースの音声/動画処理ツール。コマンドラインで `winget install ffmpeg` を実行してインストール |

---

## クイックスタート

### 1. 依存関係のダウンロード

1. `PyTorch_Download.exe` を**ダブルクリック** → **CPU版**または**CUDA版**を選択

2. ダウンロードが完了したら **Verify** をクリック（またはウィンドウを閉じてもOK）

3. `pytorch_libs\` フォルダに依存ファイルが展開されます

### 2. 音声ファイルの文字起こし

1. `Transcription.exe` を**ダブルクリック**

2. **📁 Select Audio File** をクリックして、`.wav / .mp3 / .flac …` 等の音声ファイルを選択

3. **Whisper Model** ドロップダウンからモデルサイズを選択（以下参照）

4. **オプション設定**：
   
   - **Keyword**：トピックに関連するキーワードを入力すると精度が向上
   
   - **⚙ Adjust Parameters**：詳細パラメータを微調整（次項参照）

5. **Transcription Language** を選択（または *auto* にて自動判定）、**🎯 Start Transcription** をクリック

6. 処理完了後：
   
   - **💾 保存**：`.json` / `.txt`
   
   - **🎬 字幕出力**：`.srt` / `.vtt`（PotPlayerやVLCで読み込み可能）

> **モデルキャッシュ**：初回のみモデルを  
> `C:\Users\<USERNAME>\.cache\whisper\` に自動保存。2回目以降は再ダウンロード不要です。

---

## Whisperモデルの説明

| モデルサイズ | パラメータ数 | 英語専用        | 多言語対応    | 必要VRAM | 処理速度（相対） |
| ------ | ------ | ----------- | -------- | ------ | -------- |
| tiny   | 39M    | `tiny.en`   | `tiny`   | 約1 GB  | 約10倍速    |
| base   | 74M    | `base.en`   | `base`   | 約1 GB  | 約7倍速     |
| small  | 244M   | `small.en`  | `small`  | 約2 GB  | 約4倍速     |
| medium | 769M   | `medium.en` | `medium` | 約5 GB  | 約2倍速     |
| large  | 1550M  | ―           | `large`  | 約10 GB | 標準速度（1×） |
| turbo† | 809M   | ―           | `turbo`  | 約6 GB  | 約8倍速     |

※ 速度は `large` を 1× とした相対値です。  
† `turbo` は large モデルを蒸留した高速・軽量モデルです。

---

## 調整可能なパラメータ

| パラメータ                        | 説明              | 範囲 / 型       | デフォルト（日本語最適化） |
| ---------------------------- | --------------- | ------------ | ------------- |
| `temperature`                | 出力のランダム性        | 0〜1（float）   | 0.0           |
| `best_of`                    | サンプリング回数（最良を選択） | 1〜10（int）    | 10            |
| `beam_size`                  | Beam Search の幅  | 1〜20（int）    | 10            |
| `logprob_threshold`          | 信頼度が低い単語を除外     | −5〜0（float）  | −1            |
| `no_speech_threshold`        | 無音と判定するしきい値     | 0〜1（float）   | 0.5           |
| `condition_on_previous_text` | 文脈の継続使用         | True / False | False         |

---

## 出力ファイル形式

| 形式      | 説明                  | 用途例             |
| ------- | ------------------- | --------------- |
| `.json` | 構造化データ（トークン＋時間情報付き） | 開発・分析用          |
| `.txt`  | 時間付きプレーンテキスト        | 簡易表示・全文検索       |
| `.srt`  | SubRip字幕形式          | 動画プレーヤー・編集ソフト用  |
| `.vtt`  | WebVTT形式            | HTML5動画・ストリーミング |

---

## よくある質問（FAQ）

1. **インターフェース言語を変更するには？**  
   　画面右上の `Language` ドロップダウンから中 / 日 / 英 / 韓に切り替え可能です。

2. **CUDAはインストール済なのに認識されない？**  
   　PowerShellで `nvcc --version` を実行し、バージョンが表示されるか確認してください。表示されない場合は再インストールか環境変数の設定が必要です。

3. **モデルのダウンロードが遅い？**  
   　- より速いネット回線やプロキシの使用を検討してください。  
   　- `.pt` モデルファイルを手動で `~\.cache\whisper\` に配置することで対応可能です。

4. **複数ファイルを一括で処理するには？**  
   　GUI版では1ファイルずつの処理です。`Pycode\Transcription.py` を使ってコマンドラインから `whisper.transcribe()` をループで呼び出してください。

---

> **ライセンス**：MIT  
> **作者**：Tomokoto  
> **連絡先**：heu_xuyouyan@outlook.com  
> **最終更新**：2025年6月10日
